import{c as u,a as o,b as i,w as m,d as g,e as q,f as C,g as h,r as _,o as d,t as $,h as f,F as A,i as L,E as O,j as x,k as v,l as B,v as M,n as N,m as T,p as D,q as V,s as H,u as j,x as z,y as J,z as K,A as W,B as G,C as Q}from"./vendor.c8b68da7.js";const X=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function a(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(t){if(t.ep)return;t.ep=!0;const r=a(t);fetch(t.href,r)}};X();var k=(e,s)=>{const a=e.__vccOpts||e;for(const[c,t]of s)a[c]=t;return a};const Y={computed:{currentUser(){return this.$store.state.auth.user},showAdminBoard(){return this.currentUser&&this.currentUser.roles?this.currentUser.roles.includes("ROLE_ADMIN"):!1},showModeratorBoard(){return this.currentUser&&this.currentUser.roles?this.currentUser.roles.includes("ROLE_MODERATOR"):!1}},methods:{logOut(){this.$store.dispatch("auth/logout"),this.$router.push("/login")}}},Z={id:"app"},ee={class:"navbar navbar-expand navbar-dark bg-dark"},se=o("a",{href:"/",class:"navbar-brand"},"bezKoder",-1),te={class:"navbar-nav mr-auto"},oe={class:"nav-item"},re=h(" Home "),ae={key:0,class:"nav-item"},ne=h("Admin Board"),ie={key:1,class:"nav-item"},ce=h("Moderator Board"),le={class:"nav-item"},de=h("User"),ue={key:0,class:"navbar-nav ml-auto"},me={class:"nav-item"},_e=h(" Sign Up "),he={class:"nav-item"},ge=h(" Login "),pe={key:1,class:"navbar-nav ml-auto"},fe={class:"nav-item"},ve={class:"nav-item"},be=h(" LogOut "),$e={class:"container"};function ke(e,s,a,c,t,r){const n=_("font-awesome-icon"),l=_("router-link"),p=_("router-view");return d(),u("div",Z,[o("nav",ee,[se,o("div",te,[o("li",oe,[i(l,{to:"/home",class:"nav-link"},{default:m(()=>[i(n,{icon:"home"}),re]),_:1})]),r.showAdminBoard?(d(),u("li",ae,[i(l,{to:"/admin",class:"nav-link"},{default:m(()=>[ne]),_:1})])):g("",!0),r.showModeratorBoard?(d(),u("li",ie,[i(l,{to:"/mod",class:"nav-link"},{default:m(()=>[ce]),_:1})])):g("",!0),o("li",le,[r.currentUser?(d(),q(l,{key:0,to:"/user",class:"nav-link"},{default:m(()=>[de]),_:1})):g("",!0)])]),r.currentUser?g("",!0):(d(),u("div",ue,[o("li",me,[i(l,{to:"/register",class:"nav-link"},{default:m(()=>[i(n,{icon:"user-plus"}),_e]),_:1})]),o("li",he,[i(l,{to:"/login",class:"nav-link"},{default:m(()=>[i(n,{icon:"sign-in-alt"}),ge]),_:1})])])),r.currentUser?(d(),u("div",pe,[o("li",fe,[i(l,{to:"/profile",class:"nav-link"},{default:m(()=>[i(n,{icon:"user"}),h(" "+$(r.currentUser.username),1)]),_:1})]),o("li",ve,[o("a",{class:"nav-link",onClick:s[0]||(s[0]=C((...R)=>r.logOut&&r.logOut(...R),["prevent"]))},[i(n,{icon:"sign-out-alt"}),be])])])):g("",!0)]),o("div",$e,[i(p)])])}var we=k(Y,[["render",ke]]);const ye="modulepreload",I={},Se="/",w=function(s,a){return!a||a.length===0?s():Promise.all(a.map(c=>{if(c=`${Se}${c}`,c in I)return;I[c]=!0;const t=c.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${r}`))return;const n=document.createElement("link");if(n.rel=t?"stylesheet":ye,t||(n.as="script",n.crossOrigin=""),n.href=c,document.head.appendChild(n),t)return new Promise((l,p)=>{n.addEventListener("load",l),n.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})})).then(()=>s())};function y(){let e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{Authorization:"Bearer "+e.accessToken}:{}}const b="http://localhost:8080/api/test/";class Ie{getPublicContent(){return f.get(b+"all")}getUserBoard(){return f.get(b+"user",{headers:y()})}getModeratorBoard(){return f.get(b+"mod",{headers:y()})}getAdminBoard(){return f.get(b+"admin",{headers:y()})}}var Ue=new Ie;const Ee={name:"Home",data(){return{content:""}},mounted(){Ue.getPublicContent().then(e=>{this.content=e.data},e=>{this.content=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()})}},Pe={class:"container"},Ae={class:"jumbotron"};function Le(e,s,a,c,t,r){return d(),u("div",Pe,[o("header",Ae,[o("h3",null,$(t.content),1)])])}var U=k(Ee,[["render",Le]]);const Oe={name:"Login",components:{Form:A,Field:L,ErrorMessage:O},data(){const e=x().shape({username:v().required("Username is required!"),password:v().required("Password is required!")});return{loading:!1,message:"",schema:e}},computed:{loggedIn(){return this.$store.state.auth.status.loggedIn}},created(){this.loggedIn&&this.$router.push("/profile")},methods:{handleLogin(e){this.loading=!0,this.$store.dispatch("auth/login",e).then(()=>{this.$router.push("/profile")},s=>{this.loading=!1,this.message=s.response&&s.response.data&&s.response.data.message||s.message||s.toString()})}}},xe={class:"col-md-12"},Be={class:"card card-container"},Me=o("img",{id:"profile-img",src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",class:"profile-img-card"},null,-1),Fe={class:"form-group"},Re=o("label",{for:"username"},"Username",-1),qe={class:"form-group"},Ce=o("label",{for:"password"},"Password",-1),Ne={class:"form-group"},Te=["disabled"],De={class:"spinner-border spinner-border-sm"},Ve=o("span",null,"Login",-1),He={class:"form-group"},je={key:0,class:"alert alert-danger",role:"alert"};function ze(e,s,a,c,t,r){const n=_("Field"),l=_("ErrorMessage"),p=_("Form");return d(),u("div",xe,[o("div",Be,[Me,i(p,{onSubmit:r.handleLogin,"validation-schema":t.schema},{default:m(()=>[o("div",Fe,[Re,i(n,{name:"username",type:"text",class:"form-control"}),i(l,{name:"username",class:"error-feedback"})]),o("div",qe,[Ce,i(n,{name:"password",type:"password",class:"form-control"}),i(l,{name:"password",class:"error-feedback"})]),o("div",Ne,[o("button",{class:"btn btn-primary btn-block",disabled:t.loading},[B(o("span",De,null,512),[[M,t.loading]]),Ve],8,Te)]),o("div",He,[t.message?(d(),u("div",je,$(t.message),1)):g("",!0)])]),_:1},8,["onSubmit","validation-schema"])])])}var Je=k(Oe,[["render",ze]]);const Ke={name:"Register",components:{Form:A,Field:L,ErrorMessage:O},data(){const e=x().shape({username:v().required("Username is required!").min(3,"Must be at least 3 characters!").max(20,"Must be maximum 20 characters!"),email:v().required("Email is required!").email("Email is invalid!").max(50,"Must be maximum 50 characters!"),password:v().required("Password is required!").min(6,"Must be at least 6 characters!").max(40,"Must be maximum 40 characters!")});return{successful:!1,loading:!1,message:"",schema:e}},computed:{loggedIn(){return this.$store.state.auth.status.loggedIn}},mounted(){this.loggedIn&&this.$router.push("/profile")},methods:{handleRegister(e){this.message="",this.successful=!1,this.loading=!0,this.$store.dispatch("auth/register",e).then(s=>{this.message=s.message,this.successful=!0,this.loading=!1},s=>{this.message=s.response&&s.response.data&&s.response.data.message||s.message||s.toString(),this.successful=!1,this.loading=!1})}}},We={class:"col-md-12"},Ge={class:"card card-container"},Qe=o("img",{id:"profile-img",src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",class:"profile-img-card"},null,-1),Xe={key:0},Ye={class:"form-group"},Ze=o("label",{for:"username"},"Username",-1),es={class:"form-group"},ss=o("label",{for:"email"},"Email",-1),ts={class:"form-group"},os=o("label",{for:"password"},"Password",-1),rs={class:"form-group"},as=["disabled"],ns={class:"spinner-border spinner-border-sm"},is=h(" Sign Up ");function cs(e,s,a,c,t,r){const n=_("Field"),l=_("ErrorMessage"),p=_("Form");return d(),u("div",We,[o("div",Ge,[Qe,i(p,{onSubmit:r.handleRegister,"validation-schema":t.schema},{default:m(()=>[t.successful?g("",!0):(d(),u("div",Xe,[o("div",Ye,[Ze,i(n,{name:"username",type:"text",class:"form-control"}),i(l,{name:"username",class:"error-feedback"})]),o("div",es,[ss,i(n,{name:"email",type:"email",class:"form-control"}),i(l,{name:"email",class:"error-feedback"})]),o("div",ts,[os,i(n,{name:"password",type:"password",class:"form-control"}),i(l,{name:"password",class:"error-feedback"})]),o("div",rs,[o("button",{class:"btn btn-primary btn-block",disabled:t.loading},[B(o("span",ns,null,512),[[M,t.loading]]),is],8,as)])]))]),_:1},8,["onSubmit","validation-schema"]),t.message?(d(),u("div",{key:0,class:N(["alert",t.successful?"alert-success":"alert-danger"])},$(t.message),3)):g("",!0)])])}var ls=k(Ke,[["render",cs]]);const ds=()=>w(()=>import("./Profile.128e2824.js"),["assets/Profile.128e2824.js","assets/vendor.c8b68da7.js"]),us=()=>w(()=>import("./BoardAdmin.fdd1d17c.js"),[]),ms=()=>w(()=>import("./BoardModerator.1b78be53.js"),[]),_s=()=>w(()=>import("./BoardUser.0084c66a.js"),["assets/BoardUser.0084c66a.js","assets/vendor.c8b68da7.js"]),hs=[{path:"/",name:"home",component:U},{path:"/home",component:U},{path:"/login",component:Je},{path:"/register",component:ls},{path:"/profile",name:"profile",component:ds},{path:"/admin",name:"admin",component:us},{path:"/mod",name:"moderator",component:ms},{path:"/user",name:"user",component:_s}],F=T({history:D(),routes:hs});F.beforeEach((e,s,a)=>{const t=!["/login","/register","/home"].includes(e.path),r=localStorage.getItem("user");t&&!r?a("/login"):a()});const E="https://alive-agenda-clinica.herokuapp.com/api/v1/token/";class gs{async login(s){const a=await f.post(E+"signin",{username:s.username,password:s.password});return a.data.accessToken&&localStorage.setItem("user",JSON.stringify(a.data)),a.data}logout(){localStorage.removeItem("user")}register(s){return f.post(E+"signup",{username:s.username,email:s.email,password:s.password})}}var S=new gs;const P=JSON.parse(localStorage.getItem("user")),ps=P?{status:{loggedIn:!0},user:P}:{status:{loggedIn:!1},user:null},fs={namespaced:!0,state:ps,actions:{login({commit:e},s){return S.login(s).then(a=>(e("loginSuccess",a),Promise.resolve(a)),a=>(e("loginFailure"),Promise.reject(a)))},logout({commit:e}){S.logout(),e("logout")},register({commit:e},s){return S.register(s).then(a=>(e("registerSuccess"),Promise.resolve(a.data)),a=>(e("registerFailure"),Promise.reject(a)))}},mutations:{loginSuccess(e,s){e.status.loggedIn=!0,e.user=s},loginFailure(e){e.status.loggedIn=!1,e.user=null},logout(e){e.status.loggedIn=!1,e.user=null},registerSuccess(e){e.status.loggedIn=!1},registerFailure(e){e.status.loggedIn=!1}}},vs=V({modules:{auth:fs}});H.add(j,z,J,K,W);G(we).use(F).use(vs).component("font-awesome-icon",Q).mount("#app");export{Ue as U,k as _};
